<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Two-Photon Microscopy – Bezia Lemma</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/install_julia.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/two_photon_microscopy.html">Two-Photon Microscopy</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Bezia Lemma</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Protocols</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../protocols/cryoslicing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cryo-Embedding and Slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../protocols/immunostaining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crystal Immunostaining</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../protocols/lung_culture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lung Culture</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/install_julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Julia Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/microscopy_training_checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microscopy Training Checklist</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/two_photon_microscopy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Two-Photon Microscopy</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Stories</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stories/annapurnacrescent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Annapurna Crescent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stories/coexistence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coexistence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stories/first.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First!</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Other</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../other/active_nematic_tennis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Active Nematic Tennis</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/install_julia.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/two_photon_microscopy.html">Two-Photon Microscopy</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Two-Photon Microscopy</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- TO DO: -->
<!-- include pictures of transition states, symmetries -->
<p>The most common thing I hear is the way you find the optimal excitation wavelength for two-photon microscopy is you take the normal excitation, and double it. If you are doing that, your microsocpy is deeply suboptimal. I’m not going to show a diagram of that concept here, because I don’t want to perpetuate it. Instead let me show you a spectra.</p>
<p>Here is the spectra for eGFP; normal excitation is 488 nm, but double that to 976 nm and you get about <em>half</em> the efficiency of the real peak at 926 nm.</p>
<p><img src="../assets/eGFP_2P.jpg" class="img-fluid"></p>
<p>If it were simply doubling the wavelength, those spectra would look very different.</p>
<p>And then consider the Alexa fluorophores: Alexa 488, Alexa 568, Alexa 594, Alexa 647. You’d expect optimal two-photon excitation wavelengths of 976, 1136, 1188, and 1294 nm, respectively. Instead, you’ll find peak excitations around 800 nm. In fact, you can excite almost every single Alexa fluorophore at 800 nm through two-photon excitation. Someone should really write a paper about that and make a modern database of two-photon excitation spectra while you are at it!</p>
<p>So, <strong>the optimal two-photon excitation is not double normal excitation</strong>.</p>
<section id="how-two-photon-excitation-works" class="level1 page-columns page-full">
<h1>How two-photon excitation works</h1>
<section id="a-photon-needs-enough-energy-to-excite-a-molecule." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="a-photon-needs-enough-energy-to-excite-a-molecule.">A photon needs enough energy to excite a molecule.</h2>
<p>A molecule might have two states, a ground state <span class="math inline">\(S_0\)</span>, and an excited state <span class="math inline">\(S_1\)</span>. A photon can excite the molecule to the <span class="math inline">\(S_1\)</span> state if it has enough energy.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>A photon’s energy is:</strong> <span class="math display">\[E = \frac{hc}{\lambda}\]</span></p>
<p>Where <span class="math inline">\(h\)</span> is Planck’s constant, <span class="math inline">\(c\)</span> is the speed of light, and <span class="math inline">\(\lambda\)</span> is the wavelength. The shorter the wavelength, the higher the energy.</p>
</div></div><p>If the photon does not have enough energy, it does not matter how many photons the molecule interacts with; it will not excite. If a small wave does not have enough energy to knock over a sailboat, that sailboat can withstand an infinite number of those small waves. There is an exception:</p>
</section>
<section id="the-energy-time-uncertainty-principle" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-energy-time-uncertainty-principle">The energy-time uncertainty principle</h2>
<p>There exists a timescale in which the universe does not resolve energy transitions. <span class="math display">\[ \Delta E \Delta t \ge \frac{\hbar}{2} \]</span> Where <span class="math inline">\(\hbar=h/2\pi\)</span>. <span class="math inline">\(\Delta t\)</span> is the timescale, and <span class="math inline">\(\Delta E\)</span> is the relevant energy. In the case of two-photon, the relevant energy is similar to the mismatch between the photon energy and the energy needed to excite the molecule.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>If you have an 800 nm photon, it has an energy of approximately <span class="math inline">\(2.5 \times 10^{-19} J\)</span>. If you need an energy of approximately <span class="math inline">\(5 \times 10^{-19} J\)</span>, then: <span class="math display">\[ \Delta t \approx \frac{\hbar}{2 \Delta E}\]</span> <span class="math display">\[ \approx \frac{10^{-34} \text{ J} \cdot \text{s}}{2 \times 2.5 \times 10^{-19} \text{ J}} \]</span> <span class="math display">\[ \approx 2 \times 10^{-16} \text{ s}, \]</span> roughly a femtosecond.</p>
</div></div><p>If we can introduce two photons to the molecule in a timescale smaller than <span class="math inline">\(\Delta t\)</span>, roughly a femtosecond, we can start to consider second-order interactions between the molecule and multiple “simultaneous” photons. Note the bigger the energy gap <span class="math inline">\(\Delta E\)</span> between the photon and the actual excitation that you need, the smaller the timescale <span class="math inline">\(\Delta t\)</span>.</p>
<p>To do this experimentally, we build really high-power lasers. We pulse these high-power lasers to send out all the photons in as short a chirp as we can, to increase the probability that we get one of these interactions. Also, note that you don’t need to use two photons of the same energy. If you have the luxury of having multiple two-photon lasers, it is possible to get some very good excitations from two different wavelengths coming in at the same pulse.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Symmetry Selection Rules</strong> A single photon exciting a molecule transitions the symmetry of the state, while two photons exciting a molecule do not change the symmetry of the state. So the one-photon excited state, <span class="math inline">\(S_1\)</span>, is a different (lower) state than the two-photon excited state <span class="math inline">\(S_1^+\)</span>.</p>
</div></div></section>
<section id="photon-accesses-a-different-excited-state" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="photon-accesses-a-different-excited-state">2-Photon accesses a different excited state</h2>
<p>The two-photon process does not access the same electronic state as the one-photon process. Consider exciting Alexa-647 with 800 nm instead of the prescribed 1294 nm.The shorter wavelength, 800 nm, means each photon carries <em>more</em> energy. The two-photon process for Alexa 647 is accessing an excited state, <span class="math inline">\(S_1^+\)</span>, that is higher in energy than the <span class="math inline">\(S_1\)</span> state. I think that the fact that many Alexa fluorophores can be efficiently excited around 800 nm is because these dyes, despite their varying <span class="math inline">\(S_0 \rightarrow S_1\)</span> energy gaps, have a common higher-lying electronic state that is strongly accessible with the combined energy of two 800 nm photons. The Alexa dyes are based on related rhodamine or cyanine core structures, with slight modifications to create their normal spectra, but the core structures probably possess similar higher-energy manifolds of electronic states. The presence of multiple two-photon excitation peaks for Alexa 647 at both 800 nm and 1200 nm indicates that there are at least two different electronic states that can be efficiently accessed. The 1200 nm peak is closer to the doubled wavelength, suggesting it might access a state energetically nearer to the one-photon state, while the 800 nm peak accesses a higher energy state.</p>
<p>After two-photon excitation, the higher state <span class="math inline">\(S_+\)</span> falls back to the one-photon excited state <span class="math inline">\(S_1\)</span>, which then falls back to the ground state <span class="math inline">\(S_0\)</span>. That final transition gives you the normal emission that you expect from a fluorophore. There is often a small but systematic red-shift of that final emission. Understanding where that red-shift comes from is left as an exercise to the reader.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Vibrational States</strong></p>
<p>Each electronic state (<span class="math inline">\(S_0\)</span>, <span class="math inline">\(S_1\)</span>) has many closely spaced vibrational energy levels. A molecule in the <span class="math inline">\(S_N\)</span> electronic state can be in vibrational levels <span class="math inline">\(v\)</span>.</p>
<p>When a photon is absorbed, the molecule transitions from <span class="math inline">\(S_0, v=0\)</span> to <span class="math inline">\(S_1, v\)</span> . The energy of the absorbed photon matches the energy difference between the initial vibronic state (electronic + vibrational) and the final vibronic state. Because there are many possible vibrational levels <span class="math inline">\(v\)</span> in <span class="math inline">\(S_1\)</span> that the molecule can transition to, there’s a range of photon wavelengths that can cause excitation, this results in the absorption spectrum rather than just a few precise wavelengths that work. .</p>
</div></div></section>
</section>
<section id="my-2-photon-excitations" class="level1">
<h1>My 2-Photon Excitations</h1>
<p>Here are the wavelengths I find work best for various fluorophores.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Fluorophore</th>
<th>Peak Excitation (nm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ATPRed1</td>
<td>1100</td>
</tr>
<tr class="even">
<td>Alexa 350</td>
<td>700</td>
</tr>
<tr class="odd">
<td>Alexa 405+</td>
<td>800-900</td>
</tr>
<tr class="even">
<td>Alexa 430</td>
<td>715</td>
</tr>
<tr class="odd">
<td>Alexa 488</td>
<td>800-1000</td>
</tr>
<tr class="even">
<td>Alexa 555, 555+</td>
<td>1000-1050</td>
</tr>
<tr class="odd">
<td>Alexa 568</td>
<td>800</td>
</tr>
<tr class="even">
<td>Alexa 594</td>
<td>800-850</td>
</tr>
<tr class="odd">
<td>Alexa 647, 647+</td>
<td>800, 1200</td>
</tr>
<tr class="even">
<td>Alexa 680</td>
<td>1280</td>
</tr>
<tr class="odd">
<td>Alexa 700</td>
<td>800</td>
</tr>
<tr class="even">
<td>Alexa 750</td>
<td>800</td>
</tr>
<tr class="odd">
<td>Alexa 790</td>
<td>800</td>
</tr>
<tr class="even">
<td>Brilliant Violet 421</td>
<td>450</td>
</tr>
<tr class="odd">
<td>CF 488</td>
<td>800-950</td>
</tr>
<tr class="even">
<td>CF 568</td>
<td>800, 1150</td>
</tr>
<tr class="odd">
<td>CF 750</td>
<td>800-850</td>
</tr>
<tr class="even">
<td>Dendra2 (both GFP, RFP)</td>
<td>920</td>
</tr>
<tr class="odd">
<td>Lipidspot488</td>
<td>910</td>
</tr>
<tr class="even">
<td>MitoView 633</td>
<td>850, 1125</td>
</tr>
<tr class="odd">
<td>Pkmito DeepRed</td>
<td>800</td>
</tr>
<tr class="even">
<td>Spy505</td>
<td>800</td>
</tr>
<tr class="odd">
<td>Spy555</td>
<td>860</td>
</tr>
</tbody>
</table>
</section>
<section id="some-open-questions." class="level1">
<h1>Some open questions.</h1>
<section id="how-do-you-explain-this-in-a-way-that-offers-predictive-power" class="level2">
<h2 class="anchored" data-anchor-id="how-do-you-explain-this-in-a-way-that-offers-predictive-power">How do you explain this in a way that offers predictive power?</h2>
<p>I’ve been thinking about this for years. I used to offer two explanations of two-photon, one classical, one quantum. But the right way to explain this is from quantum field theory. The question is, how can you present a quantum field theory explanation of the two-photon excitation of a molecule that provides a microscopist with any experimental intuition at all?</p>
</section>
<section id="where-are-the-models-of-spectra" class="level2">
<h2 class="anchored" data-anchor-id="where-are-the-models-of-spectra">Where are the models of spectra?</h2>
<p>There is very little experimental excitation spectra of 2P (despite the great efforts of some scientists!). There just isn’t any reward for that kind of work, and the people who build the fluorophores don’t quantify them via 2P before selling them. It does seem however for small molecules like the Janellia Fluorophores and the Alexa Fluorophores that one can model the excitation spectra using some quantum chemistry simulations. Where is it? Some enterprising physics student should do this and contact me.</p>
</section>
<section id="a-suite-of-fluorophores-that-excel-at-exciting-at-the-same-or-different-wavelength" class="level2">
<h2 class="anchored" data-anchor-id="a-suite-of-fluorophores-that-excel-at-exciting-at-the-same-or-different-wavelength">A suite of fluorophores that excel at exciting at the same or different wavelength?</h2>
<p>It would be very nice to have a single laser, and get a ton of emission that you simply seperate by wavelength. This sort of happens by accident for many small molecule fluorophores, but can you do it on purpose? Can you do it on purpose with proteins as well? Can you intentionally not do it to help minimize imaging bleedthrough?</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>